<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Predicci처n de especie de ping체ino</title>
    <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
    <h1>Estimador de especie de ping체ino</h1>
    <form id="penguinForm">
        <label>
            Largo del pico (bill_length_mm):
            <input type="number" step="0.1" name="bill_length_mm" required />
        </label>
        <br />
        <label>
            Profundidad del pico (bill_depth_mm):
            <input type="number" step="0.1" name="bill_depth_mm" required />
        </label>
        <br />
        <label>
            Largo de la aleta (flipper_length_mm):
            <input type="number" step="0.1" name="flipper_length_mm" required />
        </label>
        <br />
        <label>
            Masa corporal (body_mass_g):
            <input type="number" step="1" name="body_mass_g" required />
        </label>
        <br />
        <label>
            Modelo:
            <select name="model_name" required>
                <option value="rf">Random Forest</option>
                <option value="knn">K-Nearest Neighbors</option>
            </select>
        </label>
        <br /><br />
        <button type="submit">Predecir especie</button>
    </form>

    <h2>Resultado:</h2>
    <div id="result"></div>

    <script>
        const form = document.getElementById("penguinForm");
        const resultDiv = document.getElementById("result");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            // Recoger datos del formulario
            const formData = new FormData(form);
            const data = {
                bill_length_mm: parseFloat(formData.get("bill_length_mm")),
                bill_depth_mm: parseFloat(formData.get("bill_depth_mm")),
                flipper_length_mm: parseFloat(formData.get("flipper_length_mm")),
                body_mass_g: parseFloat(formData.get("body_mass_g")),
            };
            const model_name = formData.get("model_name");

            try {
                const response = await fetch(`/predict?model_name=${model_name}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data),
                });

                if (!response.ok) {
                    throw new Error(`Error en la petici처n: ${response.statusText}`);
                }

                const result = await response.json();

                resultDiv.innerHTML = `
                    <p><strong>Especie predicha:</strong> ${result.especie}</p>
                    <p><strong>Modelo usado:</strong> ${result.modelo_usado}</p>
                `;
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
            }
        });
    </script>
</body>
</html>
